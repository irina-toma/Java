<!DOCTYPE html>
<html>
<head>
<meta charset="ISO-8859-1">
<title>Insert title here</title>

	<script>
		document.addEventListener("DOMContentLoaded", onLoad);
		
		function onLoad() {
			// eveniment de click pe butonul add new todo
			var addBtn = document.getElementById("addBtn");
			addBtn.addEventListener("click", onClickAddBtn);
			
			populateTodoTable();
			
		}
		
		function populateTodoTable() {
			var table = document.getElementById("todoTable");
			
			var request = new XMLHttpRequest();
			request.open("GET", "http://localhost:8080/api/todo");
			request.send();
			
			request.onload = () => {
				var todoList = JSON.parse(request.response); 
				for (var todo of todoList) {
					/*
					<tr>
						<td>Titlu</td>
						<td>
							<button>x</button>
						</td>
					</tr>
					*/
					
					var row = document.createElement("tr");
					var tdTitle = document.createElement("td");
					var tdDesc = document.createElement("td");
					var deleteBtn = document.createElement("button");
					
					deleteBtn.innerHTML = "X";
					tdTitle.innerHTML = todo.title;
					
					tdDesc.appendChild(deleteBtn);
					row.appendChild(tdTitle);
					row.appendChild(tdDesc);
					
					table.appendChild(row);
					
					tdTitle.setAttribute("data-id", todo.id);
					tdTitle.addEventListener("click", onClickTodoTitle);
					
				}
				
				/*for (var i = 0; i < todoList.length; i ++) {
					var todo = todoList[i];
				}*/
			}
		}
		
		function onClickTodoTitle(event) {
			var target = event.target;
			console.log(target);
			
			var id = target.getAttribute("data-id");
			
			// call AJAX pt a lua descrierea
			var request = new XMLHttpRequest();
			request.open("GET", "http://localhost:8080/api/todos/" + id);
			request.send();
			
			request.onload = () => {
				// primim un singur element Todo
				var todo = JSON.parse(request.response);
				var details = document.getElementById("todoDetails");
				details.innerHTML = todo.desc;
			}
		}
		
		function onClickAddBtn() {}
		
		
	</script>	
</head>



<body>
	<p>My TODO list</p>
	<button id="addBtn">Add</button>
	<table id="todoTable">
		<th>
			<td>Title</td>
			<td>Delete</td>
		</th>
		<!-- adaugam randurile automat -->
	</table>
	<div id="todoDetails"></div>
	
</body>
</html>